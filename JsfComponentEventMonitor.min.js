function JSFx(){this.config=[],this.prevClickJQ=[],this.prevClickJQhandler=[],this.prevSelectedChild=[],this.timeClicked=[],this.executing=[],this.log=!1,this.jsfComponents=[],this.childrenToDisable=[],this.alreadyCreatedAspect=[],this.elemHasDelegator=[],this.elemIsDelegator=[],this.me=this}var jsfX=new JSFx;JSFx.prototype.findEvents=function(a,b){var c=findEventHandlers("click",a,b);return c},JSFx.prototype.convertElemBackToQueryString=function(a,b,c,d){if(a.attr("id")||jsfX.config[d].isAlone)return $("#"+a.attr("id").replace(/:/g,"\\:"));var e=b.find(c),f=e.index(a);return-1==f?null:get$selector(a).replace(/:/g,"\\:")},JSFx.prototype.$jsfToCompId=function(a){if(void 0==a)return"";for(var b in jsfX.config){var c=jsfX.config[b].jsfComponent;if($(b)[0]==a[0])return b;var d=jsfX.config[b].children,e=a.closest(c);if(e.length>0&&-1!==$(c).find(d).index(a))return b}},JSFx.prototype.resetAspectState=function(){for(var a in jsfX.alreadyCreatedAspect)jsfX.alreadyCreatedAspect[a]=!1},JSFx.prototype.interceptFunc=function(a,b,c,d){a.addClass("interceptor").addClass("monitorEvents"),a.off("click",jsfX.interceptAspect).bindFirst("click",jsfX.interceptAspect),jsfX.alreadyCreatedAspect[b]=!0,jsfX.prevClickJQhandler[b]||(jsfX.prevClickJQhandler[b]=[]),-1!==d.toString().indexOf("@Dummy")?jsfX.prevClickJQhandler[b].push(function(){}):-1===$.inArray(d,jsfX.prevClickJQhandler[b])&&jsfX.prevClickJQhandler[b].push(d)},JSFx.prototype.cancelNonJSFxclickAndApplyAspect=function(a,b,c){var d=jsfX.$jsfToCompId(b);if(jsfX.config[d].funcHandle)return jsfX.interceptFunc(b,c,d,jsfX.config[d].funcHandle),b;var e=null;if(!a)return e;if(a[0]&&a[0].events)for(var f=0;f<a.length;f++)for(var g=a[f].events.length,h=0;g>h;h++){var i=a[f].events[h].handler;if(-1===i.toString().indexOf("@jsfX")&&-1===i.toString().indexOf("@Before")){var j=a[f].element,k=$(j);e=k;var l=jsfX.getStaticId(k),m=i;if(0!==b.closest(k).length){var n=k,o=jsfX.findEvents(n,"allDescendants");if(!o)return e;if(o[0]&&o[0].events)for(var p=0;p<o.length;p++)for(var q=o[p].events.length,r=0;q>r;r++){var s=o[p].events[r].handler;if(-1===s.toString().indexOf("@jsfX")&&-1===s.toString().indexOf("@Before")){var t=o[p].events[r].targets,u=$.inArray(b[0],t);-1!==u&&jsfX.interceptFunc(b,c,d,s)}}}else get$selector(k)==get$selector(b)&&jsfX.interceptFunc(k,l,d,m)}}return e},JSFx.prototype.tempDisableComponent=function(a,b,c){if(!jsfX.hasAspect(a)){var d=jsfX.findEvents(a,"allDescendants"),e=jsfX.$jsfToCompId(a),f=jsfX.config[e].jsfComponent;if(!(d&&0!=d.length||(d=jsfX.findEvents($(f),"allDescendants"),d&&0!=d.length)))return;jsfX.log&&console.log(a.attr("id"));var g=jsfX.getStaticId(a),h=null,i=jsfX.cancelNonJSFxclickAndApplyAspect(d,a,g);if(!i||!jsfX.prevClickJQhandler[g]||0==jsfX.prevClickJQhandler[g].length){var j=$(f),k=jsfX.findEvents(j,"allDescendants");i=jsfX.cancelNonJSFxclickAndApplyAspect(k,a,g)}if(!i||!jsfX.prevClickJQhandler[g]||0==jsfX.prevClickJQhandler[g].length){for(var l=getInlineEventHandlers(a),m=g,n=0;n<l.length;n++)if(-1!==l[n].name.indexOf("click")&&l[n].ownerElement==a[0]){var o=l[n].ownerElement.onclick;a.off("click",o),a.removeAttr("onclick"),jsfX.handlersToPeriodicallyRemove||(jsfX.handlersToPeriodicallyRemove=[]),jsfX.handlersToPeriodicallyRemove[e]=o,i=a,jsfX.interceptFunc(a,m,e,o)}i&&a.off("click",jsfX.interceptAspect).bindFirst("click",jsfX.interceptAspect)}i&&(h=a),jsfX.alreadyCreatedAspect[g]=!0,h&&jsfX.interceptAspect.apply(a,c)}},JSFx.prototype.hasAspect=function(a){var b=jsfX.getStaticId(a);if(!jsfX.prevClickJQhandler[b])return!1;var c=jsfX.$jsfToCompId(a);if(!c)return!1;var d=!0,e=jsfX.findEvents(a,"elem");if(!e||0==e.length)return!0;for(var f=0;f<e.length;f++)for(var g=0;g<e[f].events.length;g++)if(d=-1!==(e[f].events[g].handler+"").indexOf("@Before"))return!0;return d},JSFx.prototype.interceptAspect=function(a){/**@jsfX@Before*/var b=$(this),c=jsfX.getStaticId(b),d=(new Date).getTime(),e=!1,f=jsfX.$jsfToCompId(b);if(f){var g=jsfX.config[f].jsfComponent,h=$(g),i=jsfX.getStaticId(h),j=jsfX.$jsfToCompId(h);if(jsfX.prevClickJQhandler[c]){jsfX[g].numOverlappingRegistrants>=2&&-1!==$.inArray(f,jsfX[g].overlappingRegistrants)?jsfX[g].bubbleFuse==jsfX[g].bubbleFuseStart?(jsfX[g].bubbleFuse--,e=!0):(jsfX[g].bubbleFuse--,jsfX[g].bubbleFuse<=0&&(e=!1,jsfX[g].bubbleFuse=jsfX[g].bubbleFuseStart)):e=!1;var k=jsfX[g].componentDisabledWaitingPeriod||2e3;if(jsfX[g].isDisabled&&d-jsfX[g].latestTimestamp<k)return jsfX.log&&console.log("entire component is currently disabled  :-D"),jsfX[g].parentElemToRunAspectOn=null,jsfX[g].childRan=!1,e=!1,a.stopPropagation(),a.preventDefault(),a.stopImmediatePropagation(),!1;jsfX[g].isDisabled=!1}if(jsfX[g].numOverlappingRegistrants>=2&&-1!==$.inArray(f,jsfX[g].overlappingRegistrants)){if(-1!==c.indexOf("__isParent")&&!jsfX[g].childRan)return jsfX[g].parentElemToRunAspectOn=$(g),void 0;-1!==c.indexOf("__isParent")&&jsfX[g].childRan?(jsfX[g].parentElemToRunAspectOn=null,jsfX[g].childRan=!1,e=!1,a.stopPropagation(),a.preventDefault(),a.stopImmediatePropagation()):-1!==c.indexOf("__isParent")||jsfX[g].parentElemToRunAspectOn?-1===c.indexOf("__isParent")&&jsfX[g].parentElemToRunAspectOn&&(jsfX[g].parentElemToRunAspectOn=null,jsfX[g].childRan=!1,e=!1,a.stopPropagation(),a.preventDefault(),a.stopImmediatePropagation()):(jsfX[g].childRan=!0,e=!0,jsfX[g].parentElemToRunAspectOn=$(g),a.stopPropagation(),a.preventDefault(),a.stopImmediatePropagation())}else a.stopPropagation(),a.preventDefault(),a.stopImmediatePropagation();jsfX[g].latestTimestamp=d;var l=jsfX.config[f].preventSelectingIfAlreadySelected,m=jsfX.config[f].selectedClass,n=jsfX.prevSelectedChild[i],o=null,p=null;if("@AlwaysStopLatestSelection"==l?(o=c,l=!0):(b.hasClass(m?m:"ui-state-highlight")&&(o=c),l=void 0==l||"true"==l?!0:!1),b.hasClass("jsfXhover")&&(p=c),jsfX.elemHasDelegator[c]){var q=jsfX.elemHasDelegator[c],r=jsfX.staticIdTo$jsf(q);if(l&&p&&n==c&&o)jsfX.log&&console.log("prevented server call!  :-D"),j&&jsfX.updateTfuse(jsfX.$jsfToCompId(h)),jsfX.config[f].onPrevent&&jsfX.config[f].onPrevent(),jsfX.updateEventsMonitor();else{var s=jsfX.timeClicked[c]||0,t=d,u=jsfX.config[f].disabledPeriod||2e3;if(jsfX.log&&console.log(t-s),t-s>u?(jsfX.config[f].onReenable&&setTimeout(jsfX.config[f].onReenable,u),jsfX.executing[c]=!1):jsfX.executing[c]=!0,!jsfX.executing[c]&&(jsfX.log&&console.log("inside:"+c),jsfX.config[f].onFirstTime&&jsfX.config[f].onFirstTime(),jsfX.prevClickJQhandler[q])){jsfX.timeClicked[c]=t;var v=jsfX.findEvents(r,"allDescendants");if(!v)return appliedAspectElem;if(v[0]&&v[0].events)for(var w=0;w<v.length;w++)for(var x=v[w].events.length,y=0;x>y;y++){var z=v[w].events[y].handler;if(-1===z.toString().indexOf("@jsfX")&&-1===z.toString().indexOf("@Before")){var A=v[w].events[y].targets,B=$.inArray(b[0],A);if(-1!==B)try{z.apply(this,arguments)}catch(C){$.proxy(z,null,arguments)}}}}}return g!==f&&(jsfX.prevSelectedChild[i]=c),jsfX.updateEventsMonitor(),e&&jsfX.activateOtherRegistrants(this,arguments,g,f,jsfX[g].overlappingRegistrants),void 0}var D=null;if(l&&p&&n==c&&o)jsfX.log&&console.log("prevented server call!  :-D"),j&&jsfX.updateTfuse(jsfX.$jsfToCompId(h)),jsfX.config[f].onPrevent&&jsfX.config[f].onPrevent(),jsfX.updateEventsMonitor();else{var s=jsfX.timeClicked[c]||0,t=d,u=jsfX.config[f].disabledPeriod||2e3;if(jsfX.log&&console.log(t-s),t-s>u?(jsfX.config[f].onReenable&&setTimeout(jsfX.config[f].onReenable,u),jsfX.executing[c]=!1,-1!==c.indexOf("__isParent")&&jsfX.config[f].preventionBehavior&&-1!==jsfX.config[f].preventionBehavior.indexOf("@DisableEntireComponentOnPrevent")&&jsfX.config[f].numTransgressionsBeforeWaitPeriod&&(jsfX.log&&console.log("transgression fuse reset"),jsfX.config[f].currTransgressionsFuse=jsfX.config[f].numTransgressionsBeforeWaitPeriod)):-1!==c.indexOf("__isParent")&&jsfX.config[f].preventionBehavior&&-1!==jsfX.config[f].preventionBehavior.indexOf("@DisableEntireComponentOnPrevent")&&jsfX.config[f].numTransgressionsBeforeWaitPeriod?((void 0===jsfX.config[f].currTransgressionsFuse||jsfX.config[f].currTransgressionsFuse<0)&&(jsfX.config[f].currTransgressionsFuse=jsfX.config[f].numTransgressionsBeforeWaitPeriod),jsfX.log&&console.log("transgression: "+jsfX.config[f].currTransgressionsFuse),jsfX.executing[c]=0==jsfX.config[f].currTransgressionsFuse?!0:!1,--jsfX.config[f].currTransgressionsFuse):jsfX.executing[c]=!0,jsfX.executing[c]){if(jsfX.log&&console.log("prevented server call!  :-D"),jsfX.config[f].onPrevent&&jsfX.config[f].onPrevent(),-1!==c.indexOf("__isParent")&&jsfX.config[f].preventionBehavior&&-1!==jsfX.config[f].preventionBehavior.indexOf("@DisableEntireComponentOnPrevent")&&(jsfX[g].isDisabled=!0,jsfX.log&&console.log("entire component is now disabled  :-D"),jsfX[g].onDisableEntireComponent&&jsfX[g].onDisableEntireComponent(),jsfX.config[f].onReenableEntireComponent)){var k=jsfX[g].componentDisabledWaitingPeriod||2e3;setTimeout(jsfX.config[f].onReenableEntireComponent,k)}}else{if(!jsfX.prevClickJQhandler[c])return jsfX.config[f].handlerSearchFuse<=0?(jsfX.log&&console.log("flagging component as handler-less"),jsfX.prevClickJQhandler[c]=[],jsfX.prevClickJQhandler[c].push(function(){})):(--jsfX.config[f].handlerSearchFuse,jsfX.mayFireEvent(b,arguments)),void 0;jsfX.timeClicked[c]=t;for(var E=[],w=0;w<jsfX.prevClickJQhandler[c].length;w++)if(-1===$.inArray(jsfX.prevClickJQhandler[c][w].toString(),E)){try{jsfX.prevClickJQhandler[c][w].apply(this,arguments)}catch(C){$.proxy(jsfX.prevClickJQhandler[c][w],null,arguments)}E.push(jsfX.prevClickJQhandler[c][w].toString())}jsfX.executing[c]=!0,jsfX.log&&console.log("inside:"+c),jsfX.config[f].onFirstTime&&jsfX.config[f].onFirstTime()}}g!==f&&(jsfX.prevSelectedChild[i]=c),jsfX.updateEventsMonitor(),D&&jsfX.fireClickHandlers(D),e&&jsfX.activateOtherRegistrants(this,arguments,g,f,jsfX[g].overlappingRegistrants)}},JSFx.prototype.updateTfuse=function(a){void 0===jsfX.config[a].currTransgressionsFuse||jsfX.config[a].disabledChildrenCanInfluenceParentTransgressionFuse||++jsfX.config[a].currTransgressionsFuse},JSFx.prototype.fireClickHandlers=function(a){if(jsfX.prevClickJQhandler[a])for(var b=[],c=0;c<jsfX.prevClickJQhandler[a].length;c++)if(-1===$.inArray(jsfX.prevClickJQhandler[a][c].toString(),b)){try{jsfX.prevClickJQhandler[a][c].apply(this,arguments)}catch(d){$.proxy(jsfX.prevClickJQhandler[a][c],null,arguments)}b.push(jsfX.prevClickJQhandler[a][c].toString())}},JSFx.prototype.activateOtherRegistrants=function(a,b,c){jsfX.interceptAspect.apply(jsfX[c].parentElemToRunAspectOn,b)},JSFx.prototype.staticIdTo$jsf=function(a){if(void 0==a)return"none";var b=a.replace(/__[\d]+/g,"");if(b==a)return $(b);var c=a.match(/__([\d]+)/);if(!c||0==c.length)return null;var d=parseInt(c[1]),e=getElementNodesIn($(b)[0]),f=$(e).eq(d);return f},JSFx.prototype.getStaticId=function(a){if(void 0==a)return"none";var b=jsfX.$jsfToCompId(a);if(void 0==b)return"none";var c=jsfX.config[b].jsfComponent,d=$(c),e=jsfX.config[b].children;return d.attr("id")==a.attr("id")?c+"__isParent":c+"__"+$(getElementNodesIn(d[0])).index($(jsfX.convertElemBackToQueryString(a,d,e,b)))},JSFx.prototype.applyMonitorClasses=function(){for(var a in jsfX.config){var b=$(jsfX.config[a].jsfComponent),c=null;if(jsfX.config[a].isAlone)c=$(b[0]);else{var d=jsfX.config[a].children;c=b.find(d)}for(var e=0;e<c.length;e++){var f=$(c[e]);f.off("click",jsfX.onClick).bindFirst("click",jsfX.onClick),f.addClass("monitorEvents").off("mouseover",jsfX.onHover).on("mouseover",jsfX.onHover).off("mouseout",jsfX.offHover).on("mouseout",jsfX.offHover)}}},JSFx.prototype.registerComponents=function(a){var b=$.isArray(a);if(b)for(var c=0;c<a.length;c++){var d=a[c],e=d.jsfComponent+(void 0==d.children?"":d.children);for(var f in d)jsfX.processConfig(d,f,e);var g=jsfX.config[e].jsfComponent,h=$(g);if(jsfX.config[e].$jsfComponent=h,!jsfX.config[e].children){jsfX.config[e].children="",jsfX.config[e].isAlone=!0;for(var i=getInlineEventHandlers(h),j=jsfX.getStaticId(h),k=0;k<i.length;k++)if(-1!==i[k].name.indexOf("click")&&i[k].ownerElement==h[0]){var l=i[k].ownerElement.onclick;h.off("click",l),h.removeAttr("onclick"),jsfX.handlersToPeriodicallyRemove||(jsfX.handlersToPeriodicallyRemove=[]),jsfX.handlersToPeriodicallyRemove[e]=l,jsfX.interceptFunc(h,j,e,l)}}jsfX.config[e].handlerSearchFuse=2,jsfX[g]?jsfX.config[e].children||jsfX[g].withoutChildren?jsfX.config[e].children&&!jsfX[g].withChildren&&(jsfX[g].withChildren=!0,jsfX[g].bubbleFuseStart<=2&&(jsfX[g].overlappingRegistrants.push(e),jsfX[g].numOverlappingRegistrants++,jsfX[g].bubbleFuseStart++,jsfX[g].bubbleFuse++)):(jsfX[g].withoutChildren=!0,jsfX[g].bubbleFuseStart<=2&&(jsfX[g].overlappingRegistrants.push(e),jsfX[g].numOverlappingRegistrants++,jsfX[g].bubbleFuseStart++,jsfX[g].bubbleFuse++)):(jsfX[g]={},jsfX.config[e].children?jsfX[g].withChildren=!0:jsfX[g].withoutChildren=!0,jsfX[g].overlappingRegistrants=[],jsfX[g].overlappingRegistrants.push(e),jsfX[g].numOverlappingRegistrants=1,jsfX[g].bubbleFuseStart=1,jsfX[g].bubbleFuse=1),jsfX.config[e].children||(jsfX[g].componentDisabledWaitingPeriod=jsfX.config[e].componentDisabledWaitingPeriod),jsfX.config[e].onDisableEntireComponent&&(jsfX[g].onDisableEntireComponent=jsfX.config[e].onDisableEntireComponent)}jsfX.enablePollingMonitor();},JSFx.prototype.showLogs=function(){jsfX.me.log=!0},JSFx.prototype.hideLogs=function(){jsfX.me.log=!1},JSFx.prototype.enablePollingMonitor=function(){if(!jsfX.pollFuncTimeout) {jsfX.me.pollFunc();}},JSFx.prototype.disablePollingMonitor=function(){clearTimeout(jsfX.pollFuncTimeout)},JSFx.prototype.pollFunc=function(){jsfX.updateEventsMonitor();var a=jsfX.config.pollingRate?jsfX.config.pollingRate:333;jsfX.pollFuncTimeout=setTimeout(jsfX.me.pollFunc,a)},JSFx.prototype.setPollingRate=function(a){jsfX.config.pollingRate=a},JSFx.prototype.processConfig=function(a,b,c){jsfX.config[c]||(jsfX.config[c]=[]),jsfX.config[c][b]=a[b]},JSFx.prototype.mayFireEvent=function(a,b){var c=jsfX.$jsfToCompId(a),d=jsfX.config[c].funcHandle,e=jsfX.getStaticId(a);a.hasClass("monitorEvents")?jsfX.tempDisableComponent(a,d,b):(jsfX.alreadyCreatedAspect[e]=!1,jsfX.tempDisableComponent(a,d,b))},JSFx.prototype.updateEventsMonitor=function(){if(jsfX.applyMonitorClasses(),jsfX.handlersToPeriodicallyRemove)for(var a in jsfX.handlersToPeriodicallyRemove)for(var b=jsfX.config[a].jsfComponent,c=jsfX.config[a].children,d=jsfX.handlersToPeriodicallyRemove[a],e=jsfX.config[a].isAlone?$(b):$(b).find(c),f=0;f<e.length;f++)$(e[f]).off("click",d),$(e[f]).removeAttr("onclick")},JSFx.prototype.onClick=function(){/**@jsfX*/var b=$(this);jsfX.log&&console.log(b.attr("id")+" :: mayFireEvent"),jsfX.mayFireEvent(b,arguments),jsfX.updateEventsMonitor()},JSFx.prototype.onHover=function(){/**@jsfX*/var a=$(this);a.addClass("jsfXhover")},JSFx.prototype.offHover=function(){/**@jsfX*/var a=$(this);a.removeClass("jsfXhover")};var get$selector=function(a){var b=a.parents().map(function(){return this.tagName}).get().reverse().join(" ");b&&(b+=" "+a[0].nodeName);var c=a.attr("id");c&&(b+="#"+c);var d=a.attr("class");return d&&(b+="."+$.trim(d).replace(/\s/gi,".")),b};Function.prototype.clone=function(){var a=this;this.__isClone&&(a=this.__clonedFrom);var b=function(){/**@jsfX@Before*/return a.apply(this,arguments)};for(var c in this)b[c]=this[c];return b.__isClone=!0,b.__clonedFrom=a,b};var getElementNodesIn=function(a){return $(a).find(":not(iframe)").addBack().contents().filter(function(){return 1==this.nodeType})};$.events=function(a){var c,b=[];return $(a).each(function(){(c=jQuery._data(this,"events"))&&b.push({element:this,events:c})}),b.length>0?b:null},$.fn.bindFirst=function(a,b){var c,d,e,f;for(this.bind(a,b),e=0,f=this.length;f>e;e++)c=this[e],d=jQuery._data(c).events[a.split(".")[0]],d.unshift(d.pop())};var findEventHandlers=function(a,b,c){var f,d=[],e=jQuery;switch(c){case"elem":f=b;break;case"allDescendants":f=b.add(b.find("*"))}var g=f.add(document);return e.each(g,function(b,c){var g=e._data(c,"events");if(void 0!==g&&void 0!==g[a]){var h=g[a];e.each(h,function(a,b){var h,g=void 0!==b.selector&&null!==b.selector;h=g?e(b.selector,c):e(c),haveCommonElements(h,f)&&addEventHandlerInfo(c,b,h,d)})}}),d},arrayIntersection=function(a,b){return $(a).filter(function(a,c){return-1!==$.inArray(c,$(b))})},haveCommonElements=function(a,b){return 0!==arrayIntersection(a,b).length},addEventHandlerInfo=function(a,b,c,d){var e=b;void 0!==c&&null!==c&&$.extend(e,{targets:c.toArray()});var f,g=$.grep(d,function(b){return a===b.element});0===g.length?(f={element:a,events:[e]},d.push(f)):(f=g[0],f.events.push(e))},getInlineEventHandlers=function(a){return $.grep(a.get(0).attributes,function(a){return/^on/i.test(a.name)&&a.value.length})};
